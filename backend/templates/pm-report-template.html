<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preventive Maintenance Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 10pt;
            line-height: 1.35;
            color: #000;
            padding: 10px;
            filter: grayscale(100%);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        .section-box {
            border: 2px solid #000;
            margin-bottom: 10px;
            padding: 8px;
        }

        .section-title {
            font-size: 11pt;
            font-weight: bold;
            margin-bottom: 6px;
            padding-bottom: 3px;
            border-bottom: 1px solid #000;
        }

        .info-table td {
            padding: 4px 6px;
            font-size: 9pt;
            border: 1px solid #ccc;
        }

        .info-label {
            font-weight: bold;
            width: 90px;
            background-color: #f0f0f0;
            white-space: nowrap;
        }

        .checklist-table {
            margin-top: 5px;
        }

        .checklist-table th {
            background-color: #333;
            color: #fff;
            padding: 5px;
            font-size: 10pt;
            text-align: center;
            border: 1px solid #000;
        }

        .checklist-table td {
            padding: 4px 5px;
            border: 1px solid #333;
            font-size: 9pt;
            text-align: center;
        }

        .checklist-table td.left-align {
            text-align: left;
        }

        .checklist-table tr:nth-child(even) {
            background-color: #f5f5f5;
        }

        .checkbox-cell {
            width: 18px;
            height: 18px;
            border: 2px solid #000;
            display: inline-block;
            text-align: center;
            line-height: 16px;
            font-size: 10pt;
            font-weight: bold;
        }

        .signature-table {
            margin-top: 10px;
        }

        .signature-table td {
            padding: 6px;
            border: 2px solid #000;
            vertical-align: top;
        }

        .signature-title {
            font-size: 10pt;
            font-weight: bold;
            text-align: center;
            margin-bottom: 6px;
            padding-bottom: 3px;
            border-bottom: 1px solid #000;
        }

        .signature-line {
            margin: 5px 0;
            font-size: 9pt;
        }

        .signature-line strong {
            display: inline-block;
            width: 70px;
        }

        .signature-underline {
            display: inline-block;
            border-bottom: 1px solid #000;
            width: 150px;
            height: 12px;
        }

        .with-logo-margin {
            margin-right: 156px;
        }

        .footer-text {
            text-align: center;
            margin-top: 10px;
            padding-top: 5px;
            border-top: 1px solid #000;
            font-size: 7pt;
        }
    </style>
</head>
<body>
    <!-- Header: Logo, Title, PM Number on same line -->
    <table style="margin-bottom: 10px; border: none;">
        <tr>
            {{#if Logo_Base64}}
            <td style="width: 60px; border: none; padding: 0; vertical-align: middle;">
                <img src="{{Logo_Base64}}" alt="Logo" style="max-height: 50px; max-width: 60px; width: auto; height: auto;">
            </td>
            {{/if}}
            <td style="background-color: #333333; border: 2px solid #000; padding: 8px; vertical-align: middle;">
                <table style="width: 100%; border: none;">
                    <tr>
                        <td style="border: none; padding: 0; text-align: center;">
                            <span style="color: #ffffff; font-size: 12pt; font-weight: bold;">Preventive Maintenance Report</span><br>
                            <span style="color: #ffffff; font-size: 8pt;">- Asset Inspection &amp; Maintenance Record -</span>
                        </td>
                        <td style="border: none; padding: 0; text-align: right; width: 150px;">
                            {{#if isBlankForm}}
                            <span style="background-color: #555555; color: #ffffff; padding: 6px 12px; border: 1px solid #ffffff; font-size: 11pt; font-weight: bold;">PM #___</span>
                            {{else}}
                            <span style="background-color: #555555; color: #ffffff; padding: 6px 12px; border: 1px solid #ffffff; font-size: 11pt; font-weight: bold;">PM #{{PM_Sequence_Number}}</span>
                            {{/if}}
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <!-- Maintenance & Agency Details with Project Logo -->
    <div class="section-box" style="position: relative;">
        {{#if Project_Logo_Base64}}
        <div style="position: absolute; top: 8px; right: 8px; z-index: 10;">
            <img src="{{Project_Logo_Base64}}" alt="Project Logo" style="max-height: 110px; max-width: 140px; border: 2px solid #000; padding: 4px; background: white;">
        </div>
        {{/if}}
        <div {{#if Project_Logo_Base64}}class="with-logo-margin"{{/if}}>
            <div style="display: block; margin-bottom: 5px; padding-bottom: 3px; border-bottom: 1px solid #000;">
                <span class="section-title" style="border-bottom: none; margin-bottom: 0; padding-bottom: 0;">Maintenance &amp; Agency Details</span>
                <span style="float: right; font-size: 9pt;">
                    <strong>PM Date:</strong> 
                    {{#if isBlankForm}}
                    <span style="border-bottom: 1px solid #000; display: inline-block; width: 100px; height: 12px;"></span>
                    {{else}}
                    {{PM_Date_Formatted}}
                    {{/if}}
                </span>
            </div>
            <table class="info-table" style="width: 100%;">
                <tr>
                    <td class="info-label" style="width: 90px;">Recipient:</td>
                    <td>{{Recipient_Name}}</td>
                </tr>
                <tr>
                    <td class="info-label" style="width: 90px;">Department:</td>
                    <td>{{Department}}</td>
                </tr>
                <tr>
                    <td class="info-label" style="width: 90px;">Position:</td>
                    <td>{{#if Position}}{{Position}}{{else}}-{{/if}}</td>
                </tr>
                <tr>
                    <td class="info-label" style="width: 90px;">Contract:</td>
                    <td>{{#if Project_Title}}{{Project_Title}}{{else}}-{{/if}}</td>
                </tr>
            </table>
        </div>
    </div>

    <!-- Asset Information -->
    <div class="section-box">
        <div class="section-title">Asset Information</div>
        <table class="info-table">
            <tr>
                <td class="info-label">Serial Number:</td>
                <td>{{Asset_Serial_Number}}</td>
                <td class="info-label">Asset Tag ID:</td>
                <td>{{Asset_Tag_ID}}</td>
                <td class="info-label">Customer:</td>
                <td>{{Customer_Name}}</td>
            </tr>
            <tr>
                <td class="info-label">Item Name:</td>
                <td>{{Item_Name}}</td>
                <td class="info-label">Category:</td>
                <td>{{Category}}</td>
                <td class="info-label">Model:</td>
                <td>{{Model}}</td>
            </tr>
            <tr>
                <td class="info-label">Remarks:</td>
                <td colspan="5">{{#if Remarks}}{{Remarks}}{{else}}-{{/if}}</td>
            </tr>
        </table>
    </div>

    <!-- Inspection Checklist -->
    <div class="section-box">
        <div class="section-title" style="letter-spacing: 0.5px;">Inspection Checklist</div>
        {{#if checklist_results}}
        <table class="checklist-table">
            <thead>
                <tr>
                    <th style="width: 30px;">No.</th>
                    <th style="width: 40%;">Checklist Item</th>
                    <th style="width: 40px;">Yes</th>
                    <th style="width: 40px;">No</th>
                    <th>Remarks</th>
                </tr>
            </thead>
            <tbody>
                {{#each checklist_results}}
                <tr>
                    <td>{{index}}</td>
                    <td class="left-align">{{Check_item_Long}}</td>
                    <td>
                        {{#if ../isBlankForm}}
                        {{else}}
                            {{#if Is_OK_bool}}
                            &#10004;
                            {{/if}}
                        {{/if}}
                    </td>
                    <td>
                        {{#if ../isBlankForm}}
                        {{else}}
                            {{#if Is_OK_bool}}
                            {{else}}
                            &#10004;
                            {{/if}}
                        {{/if}}
                    </td>
                    <td class="left-align">{{#if ../isBlankForm}}-{{else}}{{#if Remarks}}{{Remarks}}{{else}}-{{/if}}{{/if}}</td>
                </tr>
                {{/each}}
            </tbody>
        </table>
        {{else}}
        <p style="text-align: center; padding: 10px; font-weight: bold;">No checklist data available</p>
        {{/if}}
    </div>

    <!-- Accessories -->
    <div class="section-box">
        <div class="section-title" style="letter-spacing: 0.5px;">Accessories</div>
        <div style="padding: 5px;">
            {{#if peripherals}}
            {{#each peripherals}}
            <div style="margin-bottom: 3px; font-size: 8pt;">
                <strong>{{Peripheral_Type_Name}}:</strong> {{Serial_Code}}
            </div>
            {{/each}}
            {{/if}}
            <div style="margin-top: 8px;">
                <strong style="font-size: 8pt;">Other Accessories:</strong>
                <div style="border: 1px solid #000; padding: 8px; min-height: 40px; margin-top: 4px;"></div>
            </div>
        </div>
    </div>

    <!-- Signatures -->
    <table class="signature-table">
        <tr>
            <td style="width: 48%;">
                <div class="signature-title" style="letter-spacing: 0.5px;">Technician Acknowledgment</div>
                <div class="signature-line">
                    <strong>Name:</strong>
                    {{#if isBlankForm}}
                    <span class="signature-underline"></span>
                    {{else}}
                    {{Created_By_Name}}
                    {{/if}}
                </div>
                <div class="signature-line">
                    <strong>Signature:</strong>
                    <span class="signature-underline"></span>
                </div>
                <div class="signature-line">
                    <strong>Date:</strong>
                    {{#if isBlankForm}}
                    <span class="signature-underline"></span>
                    {{else}}
                    {{PM_Date_Formatted}}
                    {{/if}}
                </div>
            </td>
            <td style="width: 2%; border: none;"></td>
            <td style="width: 48%;">
                <div class="signature-title" style="letter-spacing: 0.5px;">Recipient Acknowledgment</div>
                <div class="signature-line">
                    <strong>Name:</strong>
                    {{Recipient_Name}}
                </div>
                <div class="signature-line">
                    <strong>Department:</strong>
                    {{Department}}
                </div>
                <div class="signature-line">
                    <strong>Signature:</strong>
                    <span class="signature-underline"></span>
                </div>
                <div class="signature-line">
                    <strong>Date:</strong>
                    <span class="signature-underline"></span>
                </div>
            </td>
        </tr>
    </table>

    <!-- Footer -->
    <div class="footer-text">
        <strong>Inventra Asset Management System</strong> | Generated on: {{Generated_Date}}
    </div>
</body>
</html>
